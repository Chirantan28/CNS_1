{% extends "base.html" %}
{% block content %}
<h1>Scan Results</h1>
{% if results.error %}
    <p>Error: {{ results.error }}</p>
{% else %}
    <table>
        <tr>
            <th>IP Address</th>
            <th>State</th>
        </tr>
        <tr>
            <td>{{ results.host }}</td>
            <td>{{ results.state }}</td>
        </tr>
    </table>

    <h2>Protocols</h2>
    {% for proto, ports in results.protocols.items() %}
        <h3>{{ proto }}</h3>
        <table>
            <tr>
                <th>Port</th>
                <th>Name</th>
                <th>Product</th>
                <th>Version</th>
                <th>Extra Info</th>
                <th>Vulnerabilities</th>
            </tr>
            {% for port, info in ports.items() %}
            <tr>
                <td>{{ port }}</td>
                <td>{{ info.name }}</td>
                <td>{{ info.product }}</td>
                <td>{{ info.version }}</td>
                <td>{{ info.extrainfo }}</td>
                <td>
                    {% if info.vulnerabilities %}
                        <ul>
                            {% for vuln, details in info.vulnerabilities.items() %}
                                <li>{{ vuln }}: {{ details }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        No vulnerabilities found
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    {% endfor %}
{% endif %}
<a href="{{ url_for('index') }}">Back</a>
{% endblock %}